version: '3.1'
forms:
  zipcode_form:
    required_slots:
    - legal_age
    - zipcode
  payment_method_form:
    required_slots:
    - payment_method
  confirmation_form:
    required_slots:
    - modify_details
entities:
- payment_method
- zipcode
- modify_details
- sunglasses_style
- face_shape
- activity_type
- brand_preference
- color_preference
- uv_protection
slots:
  zipcode:
    type: text
    mappings:
    - type: from_entity
      entity: zipcode
      conditions:
      - active_loop: zipcode_form
        requested_slot: zipcode
  legal_age:
    type: bool
    mappings:
    - type: from_intent
      intent: affirm
      value: true
      conditions:
      - active_loop: zipcode_form
        requested_slot: legal_age
    - type: from_intent
      intent: deny
      value: false
      conditions:
      - active_loop: zipcode_form
        requested_slot: legal_age
  payment_method:
    type: text
    mappings:
    - type: from_entity
      entity: payment_method
      conditions:
      - active_loop: payment_method_form
        requested_slot: payment_method
  modify_details:
    type: text
    mappings:
    - type: from_entity
      entity: modify_details
      conditions:
      - active_loop: confirmation_form
        requested_slot: modify_details
intents:
- affirm
- bot_challenge
- conversation
- deny
- finish_purchase
- goodbye
- greet
- inform
- inform_zipcode
- nlu_fallback
- cart_status
- ask_style_recommendation
- ask_face_shape_advice
- ask_uv_protection_info
- ask_brand_info
- ask_color_recommendation
- ask_activity_sunglasses
- ask_care_instructions
actions:
- utter_greet
- utter_goodbye
- correct_detail
- llm_processing
- process_cached_user_demands
- summarize_details
- validate_zipcode_form
- validate_payment_method_form
- validate_confirmation_form
- action_default_fallback
- return_cart_status
responses:
  utter_greet:
  - text: |
      ¡Hola! 👋 Bienvenido a Óptica Solar, tu tienda especializada en gafas de sol de alta calidad. Soy tu asistente virtual y estoy aquí para ayudarte a encontrar las gafas perfectas para ti. Puedo recomendarte modelos según tu estilo, forma de cara, actividades o preferencias. ¿Qué tipo de gafas de sol estás buscando?
  utter_goodbye:
  - text: ¡Hasta luego! 👋 Recuerda proteger tus ojos del sol. ¡Nos vemos pronto!
  utter_iamabot:
  - text: Sí, soy un asistente virtual especializado en gafas de sol. ¿En qué puedo ayudarte hoy?
  utter_ask_legal_age:
  - text: |
      Antes de comenzar, necesito confirmar que eres mayor de edad para realizar compras. ¿Eres mayor de 18 años?
    buttons:
    - title: Sí, soy mayor de edad.
      payload: /affirm
    - title: Soy menor de edad.
      payload: /deny
  utter_ask_zipcode:
  - text: Perfecto! Ahora necesito tu código postal para calcular los costos de envío.
  - text: Por favor, proporciona tu código postal.
  - text: Necesito tu código postal para continuar. ¿Puedes proporcionarlo?
  - text: Por favor, indica tu código postal.
  utter_submit_zipcode:
  - text: ¡Excelente! 📝 Ahora cuéntame qué tipo de gafas de sol necesitas y te ayudaré a encontrar las perfectas para ti.
  utter_submit_payment:
  - text: ¡Perfecto! 📝 Tu pedido está listo. ¡Recibirás tus gafas de sol en casa pronto!
  utter_slots_values:
  - text: |-
      Información proporcionada:
       - Código postal: {zipcode}
       - Mayor de edad: {legal_age}
  utter_please_rephrase:
  - text: Lo siento, no entendí. ¿Puedes reformular tu pregunta?
  - text: No entendí. ¿Puedes decirlo de otra manera?
  utter_zipcode_form_warning:
  - text: Antes de ayudarte, necesito que respondas las preguntas que te hice, por favor.
  - text: Antes de continuar, necesito que respondas las preguntas que te hice, por favor.
  utter_ask_payment_method:
  - text: 'Elige tu método de pago:'
    buttons:
    - title: Efectivo
      payload: /inform{{"payment_method":"Cash"}}
    - title: Tarjeta de Crédito
      payload: /inform{{"payment_method":"Credit"}}
    - title: Tarjeta de Débito
      payload: /inform{{"payment_method":"Debit"}}
    - title: MercadoPago
      payload: /inform{{"payment_method":"MercadoPago"}}
  utter_ask_modify_details:
  - text: ''
    buttons:
    - title: Cambiar código postal
      payload: /inform{{"modify_details":"zipcode"}}
    - title: Cambiar método de pago
      payload: /inform{{"modify_details":"payment_method"}}
    - title: Modificar el pedido
      payload: /inform{{"modify_details":"cart"}}
    - title: ¡Todo está correcto!
      payload: /inform{{"modify_details":"ok"}}
  utter_default:
  - text: Lo siento, no entendí. Por favor, reformula tu pregunta.
  - text: No entendí. Por favor, explícame de otra manera.
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
